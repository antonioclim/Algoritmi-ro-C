# ==============================================================================
# MAKEFILE - SÄƒptÄƒmÃ¢na 12: Grafuri - NoÈ›iuni de BazÄƒ
# ==============================================================================
#
# Utilizare:
#   make              - CompileazÄƒ toate executabilele
#   make example1     - CompileazÄƒ doar example1
#   make exercise1    - CompileazÄƒ exercise1
#   make exercise2    - CompileazÄƒ exercise2
#   make solutions    - CompileazÄƒ toate soluÈ›iile
#   make test         - RuleazÄƒ testele
#   make run          - RuleazÄƒ toate exemplele
#   make clean        - È˜terge fiÈ™ierele compilate
#   make valgrind     - VerificÄƒ memory leaks
#   make help         - AfiÈ™eazÄƒ acest mesaj
#
# ==============================================================================

# Compilator È™i flags
CC = gcc
CFLAGS = -Wall -Wextra -Wpedantic -std=c11 -g
LDFLAGS = 

# Culori pentru output
COLOR_RESET  = \033[0m
COLOR_GREEN  = \033[1;32m
COLOR_YELLOW = \033[1;33m
COLOR_BLUE   = \033[1;34m
COLOR_RED    = \033[1;31m
COLOR_CYAN   = \033[1;36m
COLOR_MAGENTA = \033[1;35m

# Simboluri
SYMBOL_OK    = âœ“
SYMBOL_FAIL  = âœ—
SYMBOL_ARROW = â†’
SYMBOL_BUILD = ğŸ”¨
SYMBOL_RUN   = ğŸš€
SYMBOL_TEST  = ğŸ§ª
SYMBOL_CLEAN = ğŸ§¹

# Directoare
SRC_DIR = src
SOL_DIR = solution
DATA_DIR = data
TEST_DIR = tests
BUILD_DIR = build

# FiÈ™iere sursÄƒ
EXAMPLE = $(SRC_DIR)/example1.c
EXERCISE1 = $(SRC_DIR)/exercise1.c
EXERCISE2 = $(SRC_DIR)/exercise2.c

# SoluÈ›ii
SOL_EX1 = $(SOL_DIR)/exercise1_sol.c
SOL_EX2 = $(SOL_DIR)/exercise2_sol.c
SOL_HW1 = $(SOL_DIR)/homework1_sol.c
SOL_HW2 = $(SOL_DIR)/homework2_sol.c

# Executabile
BINS = example1 exercise1 exercise2
SOL_BINS = exercise1_sol exercise2_sol homework1_sol homework2_sol

# ==============================================================================
# TARGETS PRINCIPALE
# ==============================================================================

.PHONY: all clean test run help solutions valgrind demo demo-all

# Target implicit
all: banner $(BINS)
	@echo ""
	@echo "$(COLOR_GREEN)$(SYMBOL_OK) Toate fiÈ™ierele compilate cu succes!$(COLOR_RESET)"
	@echo ""

# Banner de start
banner:
	@echo ""
	@echo "$(COLOR_CYAN)â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)â•‘     $(COLOR_YELLOW)$(SYMBOL_BUILD) Compilare SÄƒptÄƒmÃ¢na 12: Grafuri$(COLOR_CYAN)                        â•‘$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@echo ""

# ==============================================================================
# COMPILARE EXERCIÈšII
# ==============================================================================

# Exemplu demonstrativ
example1: $(EXAMPLE)
	@echo "$(COLOR_BLUE)$(SYMBOL_ARROW) Compilare$(COLOR_RESET) $@..."
	@$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) $@ compilat"

# ExerciÈ›iul 1: BFS
exercise1: $(EXERCISE1)
	@echo "$(COLOR_BLUE)$(SYMBOL_ARROW) Compilare$(COLOR_RESET) $@..."
	@$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) $@ compilat"

# ExerciÈ›iul 2: DFS
exercise2: $(EXERCISE2)
	@echo "$(COLOR_BLUE)$(SYMBOL_ARROW) Compilare$(COLOR_RESET) $@..."
	@$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) $@ compilat"

# ==============================================================================
# COMPILARE SOLUÈšII (pentru profesori)
# ==============================================================================

solutions: banner-sol $(SOL_BINS)
	@echo ""
	@echo "$(COLOR_GREEN)$(SYMBOL_OK) Toate soluÈ›iile compilate!$(COLOR_RESET)"
	@echo ""

banner-sol:
	@echo ""
	@echo "$(COLOR_MAGENTA)â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—$(COLOR_RESET)"
	@echo "$(COLOR_MAGENTA)â•‘     $(COLOR_YELLOW)ğŸ” Compilare SoluÈ›ii (CONFIDENÈšIAL)$(COLOR_MAGENTA)                      â•‘$(COLOR_RESET)"
	@echo "$(COLOR_MAGENTA)â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@echo ""

exercise1_sol: $(SOL_EX1)
	@echo "$(COLOR_MAGENTA)$(SYMBOL_ARROW) Compilare$(COLOR_RESET) $@..."
	@$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) $@ compilat"

exercise2_sol: $(SOL_EX2)
	@echo "$(COLOR_MAGENTA)$(SYMBOL_ARROW) Compilare$(COLOR_RESET) $@..."
	@$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) $@ compilat"

homework1_sol: $(SOL_HW1)
	@echo "$(COLOR_MAGENTA)$(SYMBOL_ARROW) Compilare$(COLOR_RESET) $@..."
	@$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) $@ compilat"

homework2_sol: $(SOL_HW2)
	@echo "$(COLOR_MAGENTA)$(SYMBOL_ARROW) Compilare$(COLOR_RESET) $@..."
	@$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) $@ compilat"

# ==============================================================================
# RULARE È˜I TESTARE
# ==============================================================================

# RuleazÄƒ exemplul
run: example1
	@echo ""
	@echo "$(COLOR_CYAN)$(SYMBOL_RUN) Rulare example1...$(COLOR_RESET)"
	@echo ""
	@./example1

# RuleazÄƒ exerciÈ›iile
run-exercises: exercise1 exercise2
	@echo ""
	@echo "$(COLOR_CYAN)$(SYMBOL_RUN) Rulare exerciÈ›ii...$(COLOR_RESET)"
	@echo ""
	@echo "$(COLOR_YELLOW)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXERCIÈšIUL 1 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./exercise1
	@echo ""
	@echo "$(COLOR_YELLOW)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXERCIÈšIUL 2 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./exercise2

# Demo complet - ruleazÄƒ exemplul È™i exerciÈ›iile
demo: example1 exercise1 exercise2
	@echo ""
	@echo "$(COLOR_CYAN)â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)â•‘     $(COLOR_YELLOW)$(SYMBOL_RUN) Demo Complet SÄƒptÄƒmÃ¢na 12$(COLOR_CYAN)                            â•‘$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@echo ""
	@echo "$(COLOR_GREEN)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXEMPLU DEMONSTRATIV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./example1
	@echo ""
	@echo "$(COLOR_YELLOW)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXERCIÈšIUL 1: BFS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./exercise1
	@echo ""
	@echo "$(COLOR_YELLOW)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXERCIÈšIUL 2: DFS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./exercise2

# Demo cu soluÈ›ii (pentru profesori)
demo-all: all solutions
	@echo ""
	@echo "$(COLOR_MAGENTA)â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—$(COLOR_RESET)"
	@echo "$(COLOR_MAGENTA)â•‘     $(COLOR_YELLOW)ğŸ“ Demo Complet cu SoluÈ›ii$(COLOR_MAGENTA)                               â•‘$(COLOR_RESET)"
	@echo "$(COLOR_MAGENTA)â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@echo ""
	@echo "$(COLOR_GREEN)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SOLUÈšIE EXERCIÈšIUL 1 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./exercise1_sol
	@echo ""
	@echo "$(COLOR_GREEN)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SOLUÈšIE EXERCIÈšIUL 2 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./exercise2_sol
	@echo ""
	@echo "$(COLOR_GREEN)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SOLUÈšIE TEMA 1: REÈšEA SOCIALÄ‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./homework1_sol
	@echo ""
	@echo "$(COLOR_GREEN)â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SOLUÈšIE TEMA 2: DEPENDENÈšE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@./homework2_sol

# Teste automate
test: all
	@echo ""
	@echo "$(COLOR_CYAN)$(SYMBOL_TEST) Rulare teste automate...$(COLOR_RESET)"
	@echo ""
	@echo "$(COLOR_YELLOW)Test 1: Verificare BFS$(COLOR_RESET)"
	@echo "Input: $(TEST_DIR)/test1_input.txt"
	@if [ -f "./exercise1" ]; then \
		echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) exercise1 existÄƒ"; \
	else \
		echo "  $(COLOR_RED)$(SYMBOL_FAIL)$(COLOR_RESET) exercise1 nu existÄƒ"; \
	fi
	@echo ""
	@echo "$(COLOR_YELLOW)Test 2: Verificare DFS$(COLOR_RESET)"
	@echo "Input: $(TEST_DIR)/test2_input.txt"
	@if [ -f "./exercise2" ]; then \
		echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) exercise2 existÄƒ"; \
	else \
		echo "  $(COLOR_RED)$(SYMBOL_FAIL)$(COLOR_RESET) exercise2 nu existÄƒ"; \
	fi
	@echo ""
	@echo "$(COLOR_GREEN)$(SYMBOL_OK) Teste completate$(COLOR_RESET)"

# Verificare memory leaks cu Valgrind
valgrind: all
	@echo ""
	@echo "$(COLOR_CYAN)ğŸ” Verificare memory leaks cu Valgrind...$(COLOR_RESET)"
	@echo ""
	@if command -v valgrind >/dev/null 2>&1; then \
		echo "$(COLOR_YELLOW)Verificare example1:$(COLOR_RESET)"; \
		valgrind --leak-check=full --show-leak-kinds=all --error-exitcode=1 ./example1 2>&1 | tail -10; \
		echo ""; \
	else \
		echo "$(COLOR_RED)Valgrind nu este instalat!$(COLOR_RESET)"; \
		echo "InstalaÈ›i cu: sudo apt install valgrind"; \
	fi

# ==============================================================================
# CURÄ‚ÈšARE
# ==============================================================================

clean:
	@echo ""
	@echo "$(COLOR_RED)$(SYMBOL_CLEAN) CurÄƒÈ›are fiÈ™iere...$(COLOR_RESET)"
	@rm -f $(BINS) $(SOL_BINS)
	@rm -f *.o
	@rm -f core
	@rm -rf $(BUILD_DIR)
	@echo "  $(COLOR_GREEN)$(SYMBOL_OK)$(COLOR_RESET) FiÈ™iere È™terse"
	@echo ""

# ==============================================================================
# AJUTOR
# ==============================================================================

help:
	@echo ""
	@echo "$(COLOR_CYAN)â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)â•‘     $(COLOR_YELLOW)ğŸ“– Ajutor Makefile - SÄƒptÄƒmÃ¢na 12$(COLOR_CYAN)                         â•‘$(COLOR_RESET)"
	@echo "$(COLOR_CYAN)â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•$(COLOR_RESET)"
	@echo ""
	@echo "$(COLOR_GREEN)Comenzi disponibile:$(COLOR_RESET)"
	@echo ""
	@echo "  $(COLOR_YELLOW)make$(COLOR_RESET)              - CompileazÄƒ exerciÈ›iile"
	@echo "  $(COLOR_YELLOW)make example1$(COLOR_RESET)     - CompileazÄƒ exemplul demonstrativ"
	@echo "  $(COLOR_YELLOW)make exercise1$(COLOR_RESET)    - CompileazÄƒ exerciÈ›iul 1 (BFS)"
	@echo "  $(COLOR_YELLOW)make exercise2$(COLOR_RESET)    - CompileazÄƒ exerciÈ›iul 2 (DFS)"
	@echo ""
	@echo "$(COLOR_MAGENTA)Pentru profesori:$(COLOR_RESET)"
	@echo ""
	@echo "  $(COLOR_YELLOW)make solutions$(COLOR_RESET)    - CompileazÄƒ soluÈ›iile"
	@echo "  $(COLOR_YELLOW)make demo-all$(COLOR_RESET)     - RuleazÄƒ demo complet cu soluÈ›ii"
	@echo ""
	@echo "$(COLOR_CYAN)Testare È™i rulare:$(COLOR_RESET)"
	@echo ""
	@echo "  $(COLOR_YELLOW)make run$(COLOR_RESET)          - RuleazÄƒ exemplul"
	@echo "  $(COLOR_YELLOW)make demo$(COLOR_RESET)         - RuleazÄƒ demo complet"
	@echo "  $(COLOR_YELLOW)make test$(COLOR_RESET)         - RuleazÄƒ teste automate"
	@echo "  $(COLOR_YELLOW)make valgrind$(COLOR_RESET)     - VerificÄƒ memory leaks"
	@echo ""
	@echo "$(COLOR_RED)CurÄƒÈ›are:$(COLOR_RESET)"
	@echo ""
	@echo "  $(COLOR_YELLOW)make clean$(COLOR_RESET)        - È˜terge fiÈ™ierele compilate"
	@echo ""
	@echo "$(COLOR_BLUE)Exemplu de utilizare:$(COLOR_RESET)"
	@echo ""
	@echo "  \$$ make                # CompileazÄƒ tot"
	@echo "  \$$ make demo           # RuleazÄƒ demonstraÈ›ia"
	@echo "  \$$ make valgrind       # VerificÄƒ memory leaks"
	@echo "  \$$ make clean          # CurÄƒÈ›Äƒ"
	@echo ""

# ==============================================================================
# INFORMAÈšII
# ==============================================================================

info:
	@echo ""
	@echo "$(COLOR_CYAN)InformaÈ›ii proiect:$(COLOR_RESET)"
	@echo "  Compilator: $(CC)"
	@echo "  Flags: $(CFLAGS)"
	@echo "  ExerciÈ›ii: $(BINS)"
	@echo "  SoluÈ›ii: $(SOL_BINS)"
	@echo ""
